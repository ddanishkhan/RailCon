//Query for updation of monthly records

INSERT INTO oldstudent(id,fullname,gender,semester,email,DOB,contact,aadhar,address,pincode,source,destination,passno,pass_end,voucher,season,classof,duration,branch,year,verified,dateofentry,datetodelete,Remark)
SELECT id,fullname,gender,semester,email,DOB,contact,aadhar,address,pincode,source,  destination,passno,pass_end,voucher,season,classof,duration,branch,year,verified,dateofentry,datetodelete,Remark
FROM student
WHERE YEAR(dateofentry) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH)
AND MONTH(dateofentry) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH)
AND duration="Monthly";

//Query for deleting
DELETE FROM student
WHERE YEAR(dateofentry) = YEAR(CURRENT_DATE - INTERVAL 1 MONTH)
AND MONTH(dateofentry) = MONTH(CURRENT_DATE - INTERVAL 1 MONTH)
AND duration="Monthly";

//EVENT

CREATE DEFINER=`root`@`localhost` EVENT `e_daily` ON SCHEDULE EVERY 10 SECOND STARTS '2018-04-09 00:00:00' ON COMPLETION PRESERVE 
ENABLE DO 

BEGIN
INSERT INTO oldstudent(id,fullname,gender,semester,email,DOB,contact,aadhar,address,pincode,source,destination,passno,pass_end,voucher,season,classof,duration,branch,year,verified,dateofentry,datetodelete,Remark)
SELECT id,fullname,gender,semester,email,DOB,contact,aadhar,address,pincode,source,  destination,passno,pass_end,voucher,season,classof,duration,branch,year,verified,dateofentry,datetodelete,Remark
FROM student
WHERE datetodelete < (NOW() - INTERVAL 1 DAY);

DELETE FROM student WHERE datetodelete < (NOW() - INTERVAL 1 DAY);
END
